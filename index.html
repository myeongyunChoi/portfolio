<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="css/main.css">
</head>

<body>

    <div id="wrap">
        <div id="load"></div>
        <div id="open_page">
            <div class="left_page"></div>
            <div class="hook">
                <p>OPNE</p> <img src="img/open_icon.png" alt="open_icon">
            </div>
            <div class="right_page"></div>
        </div>

        <div id="skill_wrap">
            <ul class="skill">
                <li class="about"></li>
                <li class="detail">
                    먀먀먀먀먀먀먀
                    <div class="detail_overlay"></div>
                </li>
                <li class="plus"></li>
            </ul>
            <a href="#" class="dm_btn"><img src="img/dm_icon.png" alt="dm_icon"> EASY <span> DM</span></a>
        </div>

        <div id="project_wrap">
            <div class="mac">
                <div class="imgbox">
                    <div class="img_overlay">
                        <h2>PROJECT</h2>
                    </div>
                    <img src="img/mac.jpg" alt="computer">
                </div>
            </div>

        </div>

        <div class="middle_line"></div>
        <div id="project">
            <div class="guide">
                <div class="site_name">
                    <h4>What i made</h4>
                </div>
                <div class="site_detail">
                    <h2>INTRODUCING OUR WEBSITE!</h2>
                    <P>Since.</P>
                    <p>여기는 사이트 설명글 5줄 이내</p>
                </div>
            </div>
            <ul class="site_view">
                <li></li>
                <li>
                    <div class="site_txt">
                        <p>Mobile Design /</p>
                        <p>Tablet Design /</p>
                        <p>Responsive Publishing /</p>
                        <p>UI Dev /</p>
                        <p>Web Dev /</p>
                    </div>
                    <div class="site_img_box">
                        <img src="img/hotel.png" alt="hotel_site">
                    </div>
                </li>
                <li>
                    <div class="site_img_box">
                        <img src="img/flower.png" alt="flower_site">
                    </div>
                    <div class="site_txt">
                        <p>Mobile Design /</p>
                        <p>Tablet Design /</p>
                        <p>Responsive Publishing /</p>
                        <p>UI Dev /</p>
                        <p>Web Dev /</p>
                    </div>
                </li>
                <li>
                    <div class="site_txt">
                        <p>UI Dev /</p>
                        <p>Web Dev /</p>
                        <p>Ajox /</p>
                    </div>
                    <div class="site_img_box">
                        <img src="img/book.png" alt="book_site">
                    </div>
                </li>
                <li>
                    <div class="site_img_box">
                        <img src="img/space.png" alt="art_site">
                    </div>
                    <div class="site_txt">
                        <p>Mobile Design /</p>
                        <p>Tablet Design /</p>
                        <p>Responsive Publishing /</p>
                        <p>UI Dev /</p>
                        <p>Web Dev /</p>
                    </div>
                </li>
                <li>
                    <div class="site_txt">
                        <p>UI Dev /</p>
                        <p>Web Dev /</p>
                    </div>
                    <div class="site_img_box">
                        <img src="img/guitar.png" alt="guitar_site">
                    </div>
                </li>
            </ul>
        </div>

        <div id="mail"></div>

    </div>

    <script src="js/main.js"></script>
    <script src="js/main_scroll.js"></script>
    <script src="js/hover.js"></script>

    <script>

        const open_page = document.getElementById("open_page");
        const page_piece = document.querySelectorAll("#open_page div");
        const left_piece = document.querySelector(".left_page");
        const hook = document.querySelector(".hook");
        const right_piece = document.querySelector(".right_page");

        const dm_btn = document.querySelector(".dm_btn");
        const dm_img = document.querySelector(".dm_btn img");

        dm_btn.addEventListener("mouseover", () => {
            dm_img.setAttribute("src", "img/dm_icon_up.png");
        });

        dm_btn.addEventListener("mouseout", () => {
            dm_img.setAttribute("src", "img/dm_icon.png");
        });

        open_page.addEventListener("wheel", function (e) {

            if (win_top == 0) {
                e.preventDefault();
            }

            if (e.deltaY > 0) {
                hook.style.transform = `translateY(-100%)`;

                setTimeout(function () {
                    left_piece.style.transform = `translatex(-100%)`;
                    right_piece.style.transform = `translatex(100%)`;

                    setTimeout(function () {
                        open_page.style.display = `none`;
                    }, 1500)
                }, 1000)
            }
        });


        const skill_wrap = document.getElementById("skill_wrap");
        const skill_wrap_wid = skill_wrap.clientWidth;
        const skill = document.querySelector(".skill");
        const skill_wid = skill.clientWidth;
        const max_mov = (skill_wid - skill_wrap_wid) * -1;
        const win_wi = window.innerWidth;
        const detail = document.querySelector(".detail");
        const detail_overlay = document.querySelector(".detail_overlay");
        //가로스크롤 최대값

        let win_top = window.scrollY;
        let move = 0;
        let mi_mo = 0;


        skill_wrap.addEventListener("wheel", (e) => {

            if (move > max_mov) {
                e.preventDefault();
            }

            if (window.scrollY <= 0) {
                move -= e.deltaY;
                if (move < max_mov) {
                    move = max_mov
                } else if (move > 0) {
                    move = 0
                }
                skill.style.transform = `translateX(${move}px)`
            }

            if(move < (win_wi /2)*-1){
                detail.classList.add("fade_in");
                detail_overlay.style.width = `100%`;
                setTimeout(function(){
                    detail_overlay.style.left= `100%`;
                },500);
            }else{
                detail.classList.remove("fade_in");
                detail_overlay.style.width = `0`;
                detail_overlay.style.left= `0`;
            }
        });


        //세로 스크롤 이벤트

        window.addEventListener("scroll", () => {

            const win_hi = window.innerHeight;

            const img_over = document.querySelector(".img_overlay");
            const img_box = document.querySelector(".imgbox");
            const middle_li = document.querySelector(".middle_line");
            const pj = document.getElementById("project");
            const pj_top = pj.offsetTop;

            let win_top = window.scrollY;
            let zoom_val = win_top - (win_hi + 200);
            let amount = 0;

            if (win_top >= win_hi) {
                img_over.style.background = "white";
                if (win_top >= win_hi + 200) {
                    zoom();
                }
            } else {
                img_over.style = "";
            }

            function zoom() {
                amount = 1 + zoom_val * 0.003;
                opa = 1 - zoom_val * 0.001;
                line = zoom_val * 0.037;

                img_box.style.transform = `scale(${amount},${amount})`;
                img_box.style.opacity = `${opa}`;

                if (opa <= 0) {
                    img_box.style = ``;
                    img_box.style.display = `none`;
                    middle_li.style.opacity = `1`;
                    if (line >= 95) {
                        line = 95;
                    } else if (line <= 5) {
                        line = 5;
                    }
                    middle_li.style.width = `${line}%`
                } else {

                    img_box.style.display = `block`;
                    middle_li.style.opacity = `0`;
                }

            }

            //프로젝트

            if (win_top >= pj_top) {
                pj.style.opacity = `1`;
            } else {
                pj.style = ``;
            }


            const site_li = document.querySelectorAll(".site_view li");
            const site_img_li = document.querySelectorAll(".site_img_box");
            const site_img = document.querySelectorAll(".site_img_box img");
            const site_txt = document.querySelectorAll(".site_txt");

            let img_zoom = 0;
            let num = 0;

            // let skew_val = 0;

            for (let i = 1; i < site_li.length; i++) {


                if (i % 2 == 0) { //짝수인 경우
                    num = i;
                } else {//홀수인 경우
                    odd = i;
                }

                let li_top = site_li[i].offsetTop + pj_top - (win_hi * 0.38);
                //부모 요소 탑 값에 자식 요소 탑값을 더한 값

                if (win_top >= li_top - win_hi) {
                    img_zoom = li_top / (win_top - 500);
                    site_img[i - 1].style.transform = `rotate3d(1, 0, -1, 33deg) scale(${img_zoom})`;
                }

                if (win_top >= li_top) {
                    // skew_val = (li_top - win_top) * 0.0013;
                    site_img_li[i - 1].style.transform = `skew(0deg, 0deg)`;
                    site_img_li[i - 1].style.marginTop = `0`;
                    middle_li.style.width = `42%`;

                    site_txt[num].style.transform = `skew(0deg, 0deg)`;
                    site_txt[num].style.marginTop = `0`;

                    site_txt[odd].style.transform = `skew(0deg, 0deg)`;
                    site_txt[odd].style.marginTop = `0`;

                } else {
                    site_img_li[i - 1].style = ``;
                    site_txt[i-1].style = ``;
                }
            }

            const mail = document.querySelector("#mail");
            const mail_top = mail.offsetTop;

            if (win_top > mail_top - win_hi) {
                middle_li.style.display = `none`;
            } else {
                middle_li.style.display = `block`;
            }
        })



    </script>
</body>

</html>